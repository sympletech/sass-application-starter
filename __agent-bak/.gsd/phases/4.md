# Phase 4: Shared Logic & Final Polish

**Objective**: DRY up the codebase by extracting duplicated patterns and perform comprehensive regression testing to ensure all refactoring is complete.

## Tasks

### 1. Extract Shared Layout Hooks
Both `PublicLayout` and `LoggedInLayout` duplicate responsive behavior, theme syncing, and drawer logic.
- Create `src/hooks/useResponsive.js`: Extract responsive resize logic (mobile detection).
- Create `src/hooks/useTheme.js`: Extract dark mode state management and theme syncing with `data-theme` attribute.
- Create `src/hooks/useDrawer.js`: Extract drawer visibility state and toggle logic.

### 2. Standardize Error Handling Utilities
Auth pages, profile, and reactivate pages show similar error-handling patterns with message displays.
- Create `src/lib/error-utils.js`: Extract reusable `handleApiError(error)` function that:
  - Checks for `error.response?.data?.error` first
  - Checks for `error.message` second
  - Falls back to a provided default message
  - Calls `message.error()` or `message.info()` as appropriate

### 3. Consolidate Logo Component
Both layouts render the same "S" logo markup with gradient background.
- Create `src/components/Logo/Logo.jsx`: Extract logo into a reusable component accepting `to` prop for link destination and `className` for wrapper customization.
- Update `PublicLayout.jsx` and `LoggedInLayout.jsx` to use the `<Logo />` component.

### 4. Verify API Integration Consistency
Ensure all pages/components using `postData` and `getData` follow consistent patterns:
- Review usage in `Login.jsx`, `Signup.jsx`, `Reactivate.jsx`, and `Profile.jsx`.
- Confirm error handling uses the new `error-utils.js`.
- Check for unused imports or duplicated API call logic.

### 5. Full Regression Testing
- Run `npm run lint` to ensure no lint errors.
- Run `npm run build` to confirm production build works cleanly.
- Start both servers (`npm start`) and manually test:
  - Public pages (Home, About, Legal)
  - Auth flows (Login, Signup, Reactivate)
  - Authenticated dashboard and profile
  - Theme toggle in light/dark mode across all layouts
  - Responsive behavior (mobile drawer, desktop menu)
  - Verify no console errors or visual regressions

## Execution
Run `/execute 4` to start.
